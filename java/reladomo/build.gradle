apply plugin: 'java'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

repositories {
  mavenCentral()
}

configurations {
    reladomoGenTask
}

ext {
    reladomoGeneratedDir = "$buildDir/generated-sources/reladomo"
}

sourceSets {
    main.java.srcDir(reladomoGeneratedDir)
}

dependencies {
    compile 'com.h2database:h2:1.4.196'
    compile 'com.goldmansachs.reladomo:reladomo:16.5.1'
    compile 'ch.qos.logback:logback-classic:1.2.3'
    reladomoGenTask 'com.goldmansachs.reladomo:reladomogen:16.5.1'
    compile 'com.goldmansachs.reladomo:reladomogen:16.5.1'
}

task('genReladomo') {
    ant.taskdef(
        name: "genReladomo",
        classpath: configurations.reladomoGenTask.asPath,
        classname: "com.gs.fw.common.mithra.generator.MithraGenerator"
    )
    ant.genReladomo(
        xml: "$projectDir/src/main/resources/ClassList.xml",
        generateGscListMethod: "true",
        generatedDir: reladomoGeneratedDir,
        nonGeneratedDir: "$projectDir/src/main/java"
    )
}
