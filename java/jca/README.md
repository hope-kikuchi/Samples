# JCA
https://docs.oracle.com/javase/jp/8/docs/technotes/guides/security/crypto/CryptoSpec.html

- Java暗号化アーキテクチャ(JCA)
    - Java 1.4 から追加された
    - 暗号技術を使うための標準 API
- JCA に含まれる API
    - プロバイダアーキテクチャ
    - デジタル署名
    - メッセージ・ダイジェスト（ハッシュ）
    - 証明書と証明書検証
    - 暗号化（対象/非対称ブロック/ストリーム暗号）
    - 鍵の生成と管理
    - 安全な乱数生成

## 設計方針
- 実装
    - 独立性
        - 個々の暗号化の実装が独立分離できる
        - プロバイダと呼ばれる単位で独立している
        - アルゴリズムを指定することで、インストールされているプロバイダから自動的に実装を取得することもできれば、プロバイダを明示して実装を取得することも可能
    - 相互操作性
        - あるプロバイダで作成された鍵を別のプロバイダの実装で利用することが可能
- アルゴリズム
    - 独立性
        - 暗号化（エンジン）の型を定義？
        - エンジン・クラス
            - `MessageDigest`
            - `Signature`
            - `KeyFactory`
            - `KeyPairGenerator`
            - `Cipher`
    - 拡張性
        - あるエンジン・クラスでのアルゴリズムの追加が容易

## アーキテクチャ
- 暗号化サービス・プロバイダ
    - CSP
    - 単にプロバイダと言ったらこれのことを指す
    - １つ以上の暗号化を実装するパッケージやパッケージ・セットのこと
        - デジタル署名アルゴリズム
        - メッセージ・ダイジェスト・アルゴリズム
        - 鍵の変換サービス
        - などなど
    - `java.security.Provider`
        - 全てのプロバイダの基底クラス
        - プロバイダには、識別のための名前がある
    - JDK には最低１つのプロバイダがインストールされている
        - プロバイダの追加は静的・動的に可能
    - JCA にあるアルゴリズムの実装を問い合わせると、インストールされているプロバイダから該当するアルゴリズムの実装を持つものが検索される
        - プロバイダには優先順位が設定されており、最初に見つかったプロバイダの実装が返さえる
        - 優先順位は変更可能
        - プロバイダを指定して実装を得ることも可能
    - `MessageDigest` クラスの、 `SHA-256` アルゴリズムでの実装を検索する例
        - `MessageDigest.getInstance("SHA-256")`
            - `"SHA-256"` というアルゴリズムの実装を提供するプロバイダが検索される
- エンジン・クラス
    - アルゴリズムの独立性を持たせるために定義された暗号化の型
    - アルゴリズムに依存しない、高い抽象度の API を定義したクラスを用意し、それを経由して暗号化技術を利用することで、アルゴリズムに依存しない実装が書ける
        - `MessageDigest`
        - `Signature`
        - `KeyFactory`
        - `KeyPairGenerator`
        - `Cipher`
    - エンジン・クラスは、内部でプロバイダが提供している実装クラスに処理を委譲している
        - `SPI` (Service Provider Interface) を実装したクラスに委譲
        - 各エンジン・クラス名の後ろに `Spi` がついた名前の抽象クラスが用意されている
            - `Cipher` クラスには `CipherSpi` が存在する
        - 各プロバイダは、この SPI クラスを継承して具体的な実装クラスを作成する
    - エンジンが提供するもの
        - 暗号化操作
            - 暗号化
            - デジタル署名
            - メッセージ・ダイジェストなど
        - 暗号化データのジェネレータ・コンバーター
            - 鍵およびアルゴリズム・パラメータ
        - カプセル化された暗号化データ
            - キーストア
            - 証明書
- 鍵管理
    - キーストア
        - 鍵および証明書のリポジトリを管理する
    - キーストアを利用するアプリケーション
        - 認証、暗号化、署名のためにデータが必要
    - `KeyStore` クラスの実装を経由してアクセスする
    - 推奨されるデフォルト・キーストア・タイプ
        - `pkcs12`
            - RSA PKCS12 Personal Information Exchange Syntax Standard に基づいている
    - 実際の、デフォルトのキーストア・タイプ
        - `jks`
            - 独自仕様形式
    - キーストアの実装も、プロバイダアーキテクチャを経由して取得する

## JCAの概念
### エンジン・クラスとアルゴリズム
- エンジン・クラス
    - 特定のアルゴリズムやプロバイダに依存しない API を定義したクラス
    - 次の機能を提供する
        - 暗号化操作
            - 暗号化
            - メッセージ・ダイジェスト
            - デジタル署名
        - 暗号化データ
            - 鍵
            - アルゴリズムパラメータのジェネレータ、コンバータ
        - 暗号化データをカプセル化し、上位の抽象レイヤーで使用できるオブジェクト
            - キーストア
            - 証明書

## コア・クラスとインターフェース
### Provider クラス
### Security クラス
### SecureRandom クラス
### MessageDigest クラス
### Signature クラス
### Cipher クラス
### Mac クラス
### Key インターフェース
### KeyPari クラス
### KeySpec インターフェース
### ファクトリおよびジェネレータ
### KeyFactory クラス
### SecretKeyFactory クラス
### KeyPariGenerator クラス
### KeyGenerator クラス
### KeyAgreement クラス
### 鍵管理
### アルゴリズム・パラメータのクラス

