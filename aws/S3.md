- Simple Storage Service の略
- バケットの作成
    - S3 に保存するデータは、「バケット」と呼ばれるものに保存される
    - まずはバケットを作成する
    - バケットには全 S3 の中で一意となる名前を付ける
        - URL の一部で利用される
- アップロード
    - コンソールからファイルをアップロードできる
- セキュリティ
    - [Amazon S3 リソースへのアクセス許可の管理 - Amazon Simple Storage Service](https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/s3-access-control.html)
    - デフォルトでは、全ての情報はプライベート（非公開）となっている
    - アクセスできるのは、そのリソース（バケットとオブジェクト）の作成者のみ
    - 他のユーザにアクセス権を付与することができる
    - アクセスポリシー
        - リソースベースのポリシー
            - リソースにアタッチされるポリシー
            - 例
                - バケットポリシー
                - アクセスコントロールリスト(ACL)
        - ユーザーポリシー
            - ユーザーにアタッチするアクセスポリシー
        - 登場要素
            - アクセス許可を取得するユーザ
            - アクセス許可の対象となるリソース
            - リソースに対して許可されるアクション
        - リソース
            - バケットとオブジェクトは **プライマリリソース** と呼ばれる
            - プライマリリソースには、 **サブリソース** を関連付けることができる
            - サブリソース
                - バケット
                    - lifecycle
                    - website
                    - versioning
                    - policy
                    - cors
                    - logging
                - オブジェクト
                    - acl
                    - restore
            - 所有者
                - リソースを作成した AWS アカウントのこと
                - IAM ユーザがリソースを作成した場合は、 IAM ユーザを作成した AWS アカウントが **親所有者** となる
        - リソースオペレーション
            - リソースを操作するための一連のオペレーション
            - [Operations on Buckets - Amazon Simple Storage Service](https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/API/RESTBucketOps.html)
            - [Operations on Objects - Amazon Simple Storage Service](https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/API/RESTObjectOps.html)
        - ACL
            - リソースにアタッチすることができる
            - アクセス許可の被付与者と付与されるアクセス許可のリスト
            - 実体は XML
        - バケットポリシー
            - バケット全体、およびオブジェクトへのアクセス許可を定義する
            - どのユーザ（匿名ユーザ含む）に、どういうアクセスを許可（不許可）するかを定義
            - 実体は JSON
        - ユーザポリシー
            - IAM ユーザ・グループ・ロールにアクセスポリシーを割り当てる
    - リクエストを許可する方法
        - リクエスタ
            - リクエストをしたユーザ
        - リクエスタが IAM ユーザの場合、次の両方から許可を受ける必要がある
            - 属する親 AWS アカウント
            - リソースを所有する AWS アカウント
    - リクエストの許可を判定する順序
        - IAM ユーザの場合
            - **ユーザコンテキスト**
                - 親 AWS アカウントからアクセス許可をもらっているかチェックする
                    - ユーザポリシーのチェックが行われる
                - ルートアカウントの場合はスキップする
                - バケット所有者ではない、別のルートアカウントからのアクセスの場合もスキップされる
            - **バケットコンテキスト**
                - バケットオペレーションを実行する場合は、バッケト所有者から許可をもらっているかチェックする
                - **バケット所有者である IAM ユーザ**からのリクエストの場合は、このチェックはスキップされる(ユーザコンテキストでのチェックだけになる)
    - ACL
        - バケットとオブジェクトのアクセス管理で使用
        - 読み取り・書き込みの権限を AWS アカウントに付与
        - 権限を付与できるのは他の AWS アカウントのみ
            - 自分の AWS アカウントには割り当てられない
        - アクセスの許可だけを割り当てることができる
            - 不許可を割り当てることはできない
        - ACL が適しているシナリオは特定のケースのみ
            - バケット所有者が他の AWS アカウントにアップロードを許可するようなケース
            - つまり、他の AWS アカウントに許可権限を特別に割り当てるときに使用する感じか
